#+STARTUP: indent hideblocks
#+TITLE: tools.user
#+AUTHOR: ajchemist


* Installation


#+begin_src sh
  clojure -Ttools install io.github.ajchemist/tools.user '{:git/sha "4668853cd4c9bf9e8171c3e5b4c032c16ea958ce"}' :as tools.user
#+end_src


* ssh


1. *passwordstore* is ssh private key store.
   - fetch from *passwordstore*
   - generate to *passwordstore*
   - private key exists in =~/.ssh/keypairs= is just cache, using only for operation
2. =~/.ssh/keypairs= is ssh public key store.


** ssh-keygen


#+begin_src sh
  clj -Ttools.user ssh-keygen
#+end_src


*** keygen with automatic generated passphrase


#+begin_src sh
  clj -Ttools.user ssh-keygen-ed25519 :group $group :name $name
#+end_src


*** keygen with user input passphrase


#+begin_src sh
  pass insert ssh/keypairs/$group/$name
  clj -Ttools.user ssh-keygen-ed25519 :group $group :name $name
#+end_src


*** install private-key on the fly


#+begin_src sh
  pass cat ssh/keypairs/$group/$user ~/.ssh/keypairs/$group/$user
#+end_src


** .ssh/config


First read =~/.ssh/hosts.edn= and generate identity files


#+begin_src sh
  clojure -Ttools.user fetch-ssh-key-from-pass
#+end_src


Read =~/.ssh/hosts.edn= to generate =~/.ssh/config=.


#+begin_src sh
  clojure -Ttools.user generate-ssh-config-file
#+end_src


First read =~/.ssh/hosts.edn= and generate identity files


#+begin_src sh
  clojure -Ttools.user ssh-keygen-all
#+end_src


Both =ssh-keygen-all= and =generate-ssh-config-file=


#+begin_src sh
  clojure -Ttools.user setup-ssh
#+end_src
